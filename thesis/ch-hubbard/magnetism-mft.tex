\section{Magnetism and mean field theory}\label{sec:magMFT}

In this section we will build a picture of magnetism in the Hubbard model in increasing level of sophistication.
As our degenerate perturbation theory  calculation of section (\ref{sec:effectiveHeisenber}) showed, the on-site interaction favors the situation in which neighboring fermions have opposite spins through an Heisenberg type interaction.
A different approach leads to the Stoner criterion for ferromagnetism.
The argument is based on creating an imbalance between the numbers of spin-up and spin-down fermions, and analyzing the interplay between the resulting increase in kinetic energy, and decrease in potential energy.
Finally, we formulate a (static) mean field theory for the Hubbard model, and discuss how it relates to the non-interacting case.

\subsection{Stoner criterion for ferromagnetism}
\label{subsec:stoner}

Pauli's exclusion principle gives a prescription on how to fill fermionic energy levels so as to yield the lowest possible total energy.
Start from the lowest level, and start filling each level of higher energy consecutively with two electrons, one of each spin.
This procedure requires the number of spin-up and spin-down electrons to be the same.
Otherwise, there is an energy cost, since we are obliged to fill higher energy levels with the excess electrons.

An unequal number of spin-up and spin-down electrons also decreases the potential energy.
An extreme example is a completely polarized lattice.
In that case, the potential energy is zero.
Partial spin polarization makes double occupation unlikely, lowering the potential energy.

\begin{figure}[H]
	\centering
\hspace{12mm}\includegraphics[trim={0 3cm 0 2cm},clip, width=0.7\linewidth]{Hubbard/DOS.pdf}
	\caption[Density of states of the \acs{1D} tight-binding model.]{Density of states of the \acs{1D} tight-binding model.
	Here we represent a polarization of the spins, which leads to an increase in kinetic energy, since the imbalance of spins forces higher energy levels to be filled.}
	\label{fig:dos}
\end{figure}

A system with density of states $N(E)$ has the density of spin-up and spin-down electrons, n, filling the energy levels up to the Fermi energy, $\varepsilon_F$.
When we reduce, say the spin-up electron density by $\delta n$, the potential energy is lowered by $\delta P = U ( n + \delta n ) ( n - \delta n ) - U n^2 = - U (\delta n)^2$.

The extra density of electrons $\delta n$ that is added to the down sector will occupy levels with energy greater than $\varepsilon_F$, so that $\delta n = N ( \varepsilon_F ) \delta E$.
Some spin-up levels below $\varepsilon_F$ that used to be occupied are now empty, which makes $\delta n$ fermions per site increase their energy by $\delta E$, leading to a change in kinetic energy $\delta K = \delta n \delta E = \frac{(\delta n)^2}{N(\varepsilon_F)}$.
The global change in energy is

\begin{equation}
\delta E = \delta P + \delta K = \bigg( - U + \frac{1}{N(\varepsilon_F)} \bigg) \big( \delta n \big)^2 = \bigg( - U N ( \varepsilon_F ) + 1 \bigg) \frac{(\delta n)^2}{N(\varepsilon_F)}
\end{equation}

If $U N ( \varepsilon_F ) > 1$, then $\delta E < 0$, and the imbalance of spin densities actually becomes more favorable.
Thus, magnetism is favored by a large on-site interaction and a large density of states at (near) the Fermi energy.

\subsection{Mean field theory of the Hubbard model}

We have already encountered an example of a mean field theory when deriving the Hubbard Hamiltonian (see appendix \ref{ap:hartree-fock}, where we provide motivation both heuristically and via a more rigorous variational approach).
In mean field theory, we give a systematic procedure to derive the most plausible quadratic Hamiltonian (which, as we know by now, is soluble) capturing some of the physics of our sytem.
In the case of the Hubbard model, to find the best possible approximation for the quartic term we start by expressing the number operators in terms of an average plus fluctuations: $n = \left\langle n \right\rangle + ( n - \left\langle n \right\rangle ) \equiv \left\langle n \right\rangle + \delta n$.
Then, we make this substitution in the interaction term and neglect the term that is second order in the fluctuations to obtain

\begin{equation}\label{eq:meanFieldNop}
\begin{split}
n_\uparrow n_\downarrow &= \bigg[ \left\langle n_\uparrow \right\rangle + ( n_\uparrow - \left\langle n_\uparrow \right\rangle ) \bigg] \bigg[ \left\langle n_\downarrow \right\rangle + ( n_\downarrow - \left\langle n_\downarrow \right\rangle ) \bigg] \\
&= \left\langle n_\uparrow \right\rangle \left\langle n_\downarrow \right\rangle + \left\langle n_\downarrow \right\rangle ( n_\uparrow - \left\langle n_\uparrow \right\rangle ) + \left\langle n_\uparrow \right\rangle ( n_\downarrow - \left\langle n_\downarrow \right\rangle ) + \mathcal{O}((\delta n)^2) \\
&= n_\uparrow \left\langle n_\downarrow \right\rangle + n_\downarrow \left\langle n_\uparrow \right\rangle - \left\langle n_\uparrow \right\rangle \left\langle n_\downarrow \right\rangle
\end{split}
\end{equation}

We consider a \say{mean field} in the sense that the average density of spin-up electrons interacts with the spin-down electrons and vice-versa.
The last term subtracts the overcounted original single interaction term.
From equation (\ref{eq:meanFieldNop}), we obtain the mean field Hamiltonian

\begin{equation}
\mathcal{H}_{\text{MF}} = - t \sum_{\left\langle i, j \right\rangle, \sigma} \bigg( c_{i\sigma}^\dagger c_{j\sigma} + c_{j\sigma}^\dagger c_{i\sigma} \bigg) + U \sum_i \bigg( n_{i,\uparrow} \left\langle n_{i, \downarrow} \right\rangle + n_{i, \downarrow} \left\langle n_{i, \uparrow} \right\rangle - \left\langle n_{i, \uparrow} \right\rangle \left\langle n_{i, \downarrow} \right\rangle \bigg)
\end{equation}

To solve $\mathcal{H}_{\text{MF}}$, one merely has to diagonalize the corresponding matrix.
In the ferromagnetic case, the average occupation is independent of the specific site, but can vary with the spin species: $n_{i, \uparrow(\downarrow)} = n \Pm m$, where $m$ is the magnetization, the order parameter of the transition to a ferromagnetic phase.
Similarly, for the \acf{AF} case on a bipartite, we consider $n_{i, \uparrow(\downarrow)} = n \Pm (-1)^{i} m$, leading to a staggered potential.

Now we take on a \acl{LG} theory kind of approach.
We compute the energy $E$ for fixed $n$ as a function of $m$, and inspect the system for ferromagnetic ordering: if the minimum lies at $m = 0$, the system is paramagnetic, otherwise it is ferromagnetic.
For simplicity, let us now consider the \acs{1D} model.
Since the average densities are site-independent, we can easily write down the polarized dispersion relations (up to an additive constant):

\begin{equation}\label{eq:meanFieldDispersion}
\varepsilon_{\uparrow k} = U ( n - m ) - 2 t \cos k \quad \varepsilon_{\downarrow k} = U ( n + m ) - 2 t \cos k ,
\end{equation}
and add these levels up for the various possible fillings of the lattice.

The computational procedure to perfom mean field computations goes as follows:
\begin{itemize}
\item Fix the lattice size $N$, the total particle number $N_p$, and the on-site interaction $U$.
\item Set the possible densities by iterating $N_\uparrow = 0, 1, ..., N_p / 2$, and $N_\downarrow = N_p - N_\downarrow$ (we only need half the values since the values are symmetric under $ N_\uparrow \leftrightarrow N_\downarrow$), and setting $n_{\uparrow, \downarrow} = N_{\uparrow, \downarrow} / N$.
\item Fill the lowest $N_\uparrow$, and $N_\downarrow$ energy levels, by looping over the allowes momentum states $k = \frac{2\pi}{N} \{ -\frac{N}{2} + 1, -\frac{N}{2}, ..., \frac{N}{2} \}$, and using equation (\ref{eq:meanFieldDispersion}).
Normalize the energy to $N$ and add in the additive constant $- \left\langle n_\uparrow \right\rangle \left\langle n_\downarrow \right\rangle$.
This step is altered for the \acs{AF} case since we are assuming the up and down densities to be identical over the whole lattice.
In such case, we fix $n = N_p / 2$ and loop over $m = 1/ N, 2 / N,...$, staying within the first Brillouin zone.
Out of the energies computed in this way for varying $N_{\uparrow, \downarrow}$, the lowest gives the magnetization for the chosen values of $N_p$ and $U$.
\end{itemize}

\begin{figure}[H]
	\centering
\hspace{12mm}\includegraphics[trim={0 0 0 0},clip, width=0.7\linewidth]{Hubbard/mfHubbard.png}
	\caption[Mean field results for the \acs{1D} Hubbard model.]{Mean field results at quarter filling for a $ 1024$ sites chain.
	$U$ is in units of $t$.
	As the on-site interaction is increased, we see a transition from a paramagnetic to a ferromagnetic phase.}
	\label{fig:mft}
\end{figure}

Let us focus on figure (\ref{fig:mft_multiple}).
At $U = 2$, the phase is paramagnetic since the energy is minimzed at $m = 0$. By $U = 4$, the phase transition is yet to occur but if you look at the energy scale in figure (\ref{fig:mft}), you will see that the energy of the spin polarized solutions decreased dramatically.
	At $U = 4.2$, the large $| m | $ energies have turned down, although $m = 0$ is still the lowest energy solution.
	At $U = 4.4$, the phase transition occurs, and the solutions with $| m | = 1$ become the lowest energy solutions: we have reached the ferromagnetic phase.

\begin{figure}[H]
	\centering
\includegraphics[trim={0 0 0 0},clip, scale = 0.35]{Hubbard/mfHubbard_multiple.png}
	\caption[Mean field results for the \acs{1D} Hubbard model: closing in on the phase transition.]{Plots of each energy curve separately giving evidence of a phase transition.
	}
	\label{fig:mft_multiple}
\end{figure}

Are these results consistent with Stoner's criterion: $U N ( \varepsilon_F ) > 1$?
First, we use the density of states obtained in section (\ref{sec:exactSolutions}) to find a relation between the density $\rho$ and the Fermi energy $\varepsilon_F$:

\begin{equation}
\rho ( \varepsilon_F ) = 2 \int_{-2t}^{\varepsilon_F} dE N ( E ) \leadsto \rho_{\text{1D}} ( \varepsilon_F ) = \frac{2}{\pi} \arccos\bigg( \frac{-\varepsilon_F}{2t}\bigg) ,
\end{equation}
which behaves as expected, i.e. $\rho ( -2 t ) = 0$,  $\rho ( 0 ) = 1$, $\rho ( 2 t ) = 2$.
In terms of the electron density:

\begin{equation}
N ( \rho ) = \frac{1}{2\pi t \sin(\pi \rho / 2)} ,
\end{equation}
and in particular we can obtain the critical value $U_c$ at which the transition to the ferromagnetic phase takes place.
At quarter filling, we have $N( 1 / 2 ) = 1 /\sqrt{2} \pi t$, giving $U_c = \sqrt{2} \pi t \approx 4.44 t$, which is about what we obtained at the mean field level\footnote{Here, there can be finite size effects due to the finite size of the chain, $N = 1024$.}.

Mean field theory can be formulated in the \ac{GCE} as well.
One simply chooses the chemical potential $\mu$, and then computes $N_{\uparrow, \downarrow}$ by filling the levels below $\mu$.
The density is changed by tuning $\mu$.
In the \ac{GCE} case, the calculation is self-consistent, and is determined iteratively\footnote{One must pay attention so as not to get stuck in metastable states.}: the densities are updates until convergence occurs.
An example of the success of mean field is the discovery of striped phases of the Hubbard model, which are crucial in cuprate superconductors.
Recent work probes these phases by the \ac{QMC} method we shall use in this thesis \cite{huang_stripe_2018}.
In fact, mean field theory is insightful, but uncontrolled.
It tends to overestimate the possibility of ordering since it always predicts a phase transition.
Even if the transition does occur, generally its details are not perfectly captured (the critical temperature, the critical exponents, ...).