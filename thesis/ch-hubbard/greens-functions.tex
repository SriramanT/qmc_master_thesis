\section{Green's functions and Wick's theorem}\label{sec:green}

Green's functions are the core of the first perturbative, diagrammatic approaches to the Hubbard model.
They are very useful in reducing the enormous amount of variables that come into play in correlated systems to a manageable number.
Here we try do give some intuition about how they work since they are the central quantity in the \acs{QMC} method we will use.
For a very complete and thorough description of the ideas in this section see \cite{fetter_quantum_2003}.

Considering the imaginary-time variable of the previous chapter $\tau = i t$, for $\tau > 0$, the Green's function is defined as

\begin{equation}
G_{\bm i \bm j} ( \tau, 0 ) = \left\langle c_{\bm i} ( \tau ) c_{\bm j}^\dagger ( 0 ) \right\rangle  \, , \text{with} \,\, c_{\bm i} ( \tau ) = e^{\mathcal{H} \tau } c_{\bm i} ( 0 ) e^{- \mathcal{H} \tau } 
\end{equation}

\subsection{Single site case}

The Hubbard Hamiltonian does not distinguish between spin-up and spin-down sectors.
Thus, without loss of generality, let us consider the spin-up sector, and compute $G_\uparrow (\tau, 0) =  \left\langle c_{\uparrow} ( \tau) c_{\uparrow}^\dagger ( 0 ) \right\rangle$.
Only the states $\left| n_{\uparrow} n_{\downarrow} \right\rangle = $ $\left| 0\, 0 \right\rangle$, $\left| 0\, 1 \right\rangle$ contribute to the expectation due to the creation operator on the right, which gives 0, unless there is no spin up electron already in the state it acts upon.

\begin{equation}
\begin{split}
c_{\uparrow} ( \tau) c_{\uparrow}^\dagger ( 0 )  \left| 0\, 0 \right\rangle &= e^{\mathcal{H} \tau } c_{\uparrow} ( 0 ) e^{-\mathcal{H} \tau } c_{\uparrow}^\dagger ( 0 )  \left| 0\, 0 \right\rangle = e^{\mathcal{H} \tau } c_{\uparrow} ( 0 ) e^{-\mathcal{H} \tau } \left| 0\, 1 \right\rangle \\
 &= e^{\mathcal{H} \tau } c_{\uparrow} ( 0 ) e^{U \tau / 4 + \mu \tau } \left| 1\, 0 \right\rangle = e^{\mathcal{H} \tau } e^{U \tau / 4 + \mu \tau } \left| 0\, 0 \right\rangle = e^{U \tau / 2 + \mu \tau } \left| 0\, 0 \right\rangle \\
 c_{\uparrow} ( \tau) c_{\uparrow}^\dagger ( 0 )  \left| 0\, 1 \right\rangle &= e^{\mathcal{H} \tau } c_{\uparrow} ( 0 ) e^{-\mathcal{H} \tau } c_{\uparrow}^\dagger ( 0 )  \left| 0\, 1 \right\rangle = e^{\mathcal{H} \tau } c_{\uparrow} ( 0 ) e^{-\mathcal{H} \tau } \left| 1\, 1 \right\rangle \\
 &= e^{\mathcal{H} \tau } c_{\uparrow} ( 0 ) e^{- U \tau / 4 + 2 \mu \tau } \left| 1\, 1 \right\rangle = e^{\mathcal{H} \tau } e^{- U \tau / 4 + 2 \mu \tau } \left| 0\, 1 \right\rangle = e^{U \tau / 2 + \mu \tau } \left| 0\, 1 \right\rangle
\end{split}
\end{equation}

Using the expression for the partition function that we obtained in equation (\ref{eq:singleSitePartition}), we arrive at

\begin{equation}
G_\uparrow (\tau, 0) = \frac{ e^{\tau ( U / 2 + \mu )} e^{-\beta U / 4} + e^{-\tau ( U / 2 - \mu )} e^{\beta (U / 4 + \mu)} }{ e^{-\beta U / 4} ( 1 + 2 e^{\beta ( U /2 + \mu)} + e^{2\beta \mu} ) } ,
\end{equation}
which, at half filling becomes

\begin{equation}
G_\uparrow (\tau, 0) = \frac{ e^{\tau U / 2} e^{-\beta U / 4} + e^{-\tau U / 2} e^{\beta U / 4 } }{ 2 e^{-\beta U / 4}  + 2 e^{\beta U / 4} } ,
\end{equation}

There is a well known relation between the Green's function and the spectral density $A ( \omega )$, which may be regarded as a local density of states:

\begin{equation}\label{eq:specDens}
G ( \tau, 0 ) =  \int_{-\infty}^{+\infty} A ( \omega ) \frac{e^{-\omega \tau} }{ e^{-\beta \omega} + 1 } d\omega ,
\end{equation}

If we replace the following expression for the spectral density in equation (\ref{eq:specDens}), we recover the result for the half filled case.

\begin{equation}
A ( \omega ) = \frac{1}{2} \bigg( \delta ( \omega - \frac{U}{2} ) + \delta ( \omega + \frac{U}{2} ) \bigg)
\end{equation}

We could do a similar calculation for $\mu \neq 0$ by changing the spectral density adequately, but the algebra is slightly more cumbersome, and the result does not bring additional insight.

The spectral density consists of two delta functions separated by $U$, which is reminiscent of our result for the Mott insulating gap.
In the same way that the gap softens (eventually disappearing) when we introduce hopping, the spectral function for the full Hubbard Hamiltonian changes accordingly, reflecting the same information about the properties of the system as the Green's function, encoded in a different manner.
In \acs{QMC}, we can access $G(\tau, 0)$ and deduce the properties of the system from it.

\subsection{Non-interacting case}

In this limit, we can compute $G_{\bm i \bm j} ( \tau, 0 )$ analytically by going to momentum space.

\begin{equation}
c_{\bm k} ( \tau ) = e^{ \mathcal{H} \tau } c_{\bm k} ( 0 ) e^{-\mathcal{H} \tau } = e^{-\varepsilon_{\bm k} \tau } c_{\bm k} ( 0 )
\end{equation}

This equation can be verified by acting with the left hand side and with right hand side on the states $\left| 0 \right\rangle$ and $\left| 1 \right\rangle$, and noting that the result is the same.
Alternatively, one can use the equation of motion $\partial_\tau \hat{A}(\tau) = [ \mathcal{H}, \hat{A} (\tau) ]$.
To generalize the result of equation (\ref{eq:eqGreenNonInt}) for the \emph{equal-time} Green's function to  \emph{unequal-time} we transform the fermionic operators in $G$ to momentum space, and use $\left\langle c_{\bm k} c_{\bm k}^\dagger \right\rangle = 1 - f_{\bm k}$ to obtain

\begin{equation}
G_{\bm i \bm j}(\tau, 0) = \frac{1}{N} \sum_{\bm k} e^{i \bm k \cdot (\bm i - \bm j )} ( 1 - f_{\bm k} ) e^{-\varepsilon_{\bm k} \tau } ,
\end{equation}
which is translationally invariant corresponding to the symmetry of the Hamiltionian.

We can generalize our definition of the Green's function by using the time-ordering operator $\mathcal{T}$:

\begin{equation}
G_{\bm k}(\tau, 0) = - \left\langle \mathcal{T} c_{\bm k} ( \tau) c_{\bm k}^\dagger ( 0 ) \right\rangle ,
\end{equation}
where

\begin{equation}
\mathcal{T} c_{\bm k} ( \tau) c_{\bm k}^\dagger ( 0 ) =
\begin{cases}
c_{\bm k} ( \tau) c_{\bm k}^\dagger ( 0 ), \,\, \tau > 0 \\
- c_{\bm k}^\dagger ( 0 ) c_{\bm k} ( \tau) , \,\, \tau < 0
\end{cases}
\end{equation}

An important property follows immediately from this definition: $G ( \tau + \beta, 0 ) = - G( \tau, 0 )$ for $ -\beta < \tau < 0$.
The imaginary-time anti-periodicity constraint implies that the frequencies that appear when we Fourier transform are the so called (fermionic) Matsubara frequencies $\omega_n = \frac{(2n + 1) \pi}{\beta}$.\footnote{Analogously, for bosons, imaginary-time periodicity implies that $\omega_n = 2n \pi / \beta$}

\begin{equation}
G ( i \omega_n ) = \int_0^\beta \frac{d\tau}{\beta} G( \tau, 0) e^{i\omega_n \tau} \quad\quad G (\tau) = \sum_n G ( i \omega_n ) e^{ - i \omega_n \tau}
\end{equation}

In momentum space, and imaginary time, the Green's function then become

\begin{equation}
G_{\bm k} (\tau, 0 ) =
\begin{cases}
-e^{-\varepsilon_{\bm k}} ( 1 - f_{\bm k} ) , \,\, 0 < \tau < \beta \\
e^{-\varepsilon_{\bm k}} f_{\bm k} , \,\, -\beta < \tau < 0 ,
\end{cases}
\end{equation}
which leads to

\begin{equation}
G_{\bm k} ( i \omega_n ) = \frac{1}{i\omega_n - \varepsilon_{\bm k} }
\end{equation}
in frequency space. This result may also be obtained by taking the partial derivative of the time-ordered Green's function written in the form $
G_{\bm k} ( \tau, 0 ) = \left\langle c_{\bm k} ( \tau) c_{\bm k}^\dagger ( 0 ) \right\rangle \theta ( \tau ) - \left\langle c_{\bm k} ( 0 ) c_{\bm k}^\dagger ( \tau ) \right\rangle \theta ( -\tau )
$
 and Fourier transforming both sides to solve for $G ( i \omega_n )$.
Taking a time derivative of $G$ implies computing commutators of $\mathcal{H}$ with the fermionic operators.
The equation closes for quadratic Hamiltonians, which we, of course, know to be soluble.

\subsection{Finite temperature Wick's theorem for fermions}
\label{subsec:wick}

As was emphasized in section \ref{sec:exactSolutions}, the key concept that will be used in deriving the auxiliary field method is a mapping to a single-particle problem defined in terms of a quadratic Hamiltonian.
Thus, Wick's theorem may be applied to simplify products of fermionic operators.
In \cite{fetter_quantum_2003}, the theorem is rigorously proven for both the ground state and the finite temperature cases.
Here, we summarize the elements that will be useful in the next chapter by following the discussion of \cite{molinari_notes_2017}, and leave a more detailed discussion to appendix \ref{ap:wick}.

A product of operators containing $k$ factors $c_i^\dagger$ and $n - k$ factors $c_i$ is brought into \emph{normal ordering} by the operator $\mathcal{N}$ (also written $: \,\,:$) defined as

\begin{equation}
\mathcal{N} [ c_1^{(\dagger)} c_2^{(\dagger)} ... c_n^{(\dagger)} ] = :  c_1^{(\dagger)} c_2^{(\dagger)} ... c_n^{(\dagger)}  : \, \equiv ( - 1 )^P c_{i_1}^{\dagger} c_{i_2}^{\dagger} ... c_{i_k}^{\dagger} c_{i_{k+1}} ... c_{i_n} ,
\end{equation}
where $P$ is the parity of the permutation $1, 2, ..., n \mapsto i_1, i_2, ..., i_n$.

It is straightforward to simplify a product of two operators: $C_1 C_2 = \mathcal{N} [ C_1 C_2 ] + \{ C_1^- , C_2^+ \} $, using the anti-commutation rules.
The last term is a c-number by assumption.
Defining a contraction as $\contraction{}{C}{ {}_1 }{C_2}
C_1 C_2 \equiv C_1 C_2 - \mathcal{N}[ C_1 C_2 ]$, we obtain $\contraction{}{C}{ {}_1 }{C_2}
C_1 C_2 =  \{ C_1^- , C_2^+ \}  $.
The definition of a contraction holds even there are other operators between the two contracted ones $C_{1, 2}$.
Wick's theorem generalizes the resullt for a product of two operators, giving an expression for the product of an arbitrary number of operators.

Let us state the ground state version of Wick's theorem for generic operators $C_i= C_i^+ + C_i^-$, where $C_i^{\Pm}$ is a combination of fermionic creation (annihilation) operators. 

\begin{equation}
C_1 C_2 ... C_n = \mathcal{N} [ C_1 C_2 ... C_n ] + \sum_{(ij)} \mathcal{N} [ C_1 C_2 ...
\contraction{}{C_i}{...}{C_j}
C_i ... C_j ... C_n ]
+ \sum_{(ij), (lm)} \mathcal{N} [ C_1 C_2 ...
\contraction{}{C}{ {}_i ... C_l ... }{C_j}
C_i ... 
\contraction[2ex]{}{C}{ {}_l ... C_j ... }{C_m}C_l ... C_j ... C_m ... C_n ] + ... ,
\end{equation}
where the first sum is over single contractions of pairs, the second one on double contractions, and so on.
For odd $n$, the last term contains single unpaired operators.
Otherwise, they are just products of contractions, which are c-numbers.

A general rule follows from the fact that the average of a normally ordered operator vanishes in the ground state.
Two-point correlation functions determine all $n$-point correlation functions.
In particular, for the case of 4 operators, using a self-explanatory abbreviated notation:

\begin{equation}
\left\langle gs | 1234 | gs \right\rangle = \left\langle 12 \right\rangle \left\langle 34 \right\rangle - \left\langle 13 \right\rangle \left\langle 24 \right\rangle + \left\langle 14 \right\rangle \left\langle 23 \right\rangle
\end{equation}

Of course, in the finite temperature case, Wick's theorem is not an operator identity because there is no non ambiguous way of defining normal ordering.
However, for non-interacting particles, the thermal average of a product of one-particle operators is still a sum over all possible contractions of pairs.
All that changes is the definition of the contraction, which is now defined in terms of the thermal average of the product of a pair of operators.
Additionally, the theorem generalizes for time-ordered products, simply by replacing the thermal averages of the pair products by time-ordered pair averages.

Our main point is that for a free theory, the $n$-particle Green's function

\begin{equation}
i^n \mathcal{G} ( x_1, x_2, ..., x_n; y_1, y_2, ... y_n ) \equiv \left\langle \mathcal{T} \psi ( x_1 ) \psi ( x_2 ) ... \psi ( x_n ) \psi^\dagger ( y_1 ) \psi^\dagger ( y_2 ) ... \psi^\dagger ( y_n ) \right\rangle
\end{equation}
is determined solely by the set of all one-particle Green's functions.
Here $x$ and $y$ denote both the complete set of quantum numbers describing the system's degrees of freedom, and imaginary time.

Applying Wick's theorem to the set of non-interacting (and thus independent) particles, we obtain

\begin{equation}
\mathcal{G} ( x_1, x_2, ... x_n; y_1, y_2,... y_n ) = \sum_P (- 1 )^P \mathcal{G}^0 ( x_1; y_{i_1} ) \mathcal{G}^0 ( x_2; y_{i_2} ) ... \mathcal{G}^0 ( x_n; y_{i_n} ) ,
\end{equation}
which corresponds to evaluating the determinant of the matrix $\bm G$, defined as $G_{ij} \equiv \mathcal{G}^0 ( x_i ; x_j )$ for $i, j = 1, 2, ..., n$.